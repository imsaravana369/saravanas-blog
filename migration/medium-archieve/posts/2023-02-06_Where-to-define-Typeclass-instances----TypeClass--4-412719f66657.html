<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Where to define Typeclass instances? — TypeClass #4</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Where to define Typeclass instances? — TypeClass #4</h1>
</header>
<section data-field="subtitle" class="p-summary">
Anywhere is not the answer…. know what are Orphan Instances?
</section>
<section data-field="body" class="e-content">
<section name="8ae5" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7c3d" id="7c3d" class="graf graf--h3 graf--leading graf--title">Where to define instances? — Understanding TypeClasses #4</h3><p name="ab80" id="ab80" class="graf graf--p graf-after--h3">In the last <a href="https://imsaravananm.medium.com/introduction-to-type-classes-1-2a7d3be0a70c" data-href="https://imsaravananm.medium.com/introduction-to-type-classes-1-2a7d3be0a70c" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">three</a> articles, we have seen a lot about type classes and have created many type classes, created lot of instances but nowhere I’d specified where we should define the instances.</p><p name="a382" id="a382" class="graf graf--p graf-after--p">Can we define it anywhere? If it’s a yes, then I would not be writing this article….</p><p name="cde7" id="cde7" class="graf graf--p graf-after--p">This is a small article but a crucial one.</p><figure name="9948" id="9948" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nq8nXyV_byZY9eDX_7Tqlg.jpeg" data-width="2400" data-height="1597" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*nq8nXyV_byZY9eDX_7Tqlg.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@alschim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@alschim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Alexander Schimmeck</a> on <a href="https://unsplash.com/photos/Aohf8gqa7Zc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/Aohf8gqa7Zc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure><h4 name="0ecd" id="0ecd" class="graf graf--h4 graf-after--figure">Where can we define the instances?</h4><p name="8155" id="8155" class="graf graf--p graf-after--h4">There are only two places where we can define instances for any typeclass.</p><ol class="postList"><li name="878f" id="878f" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">The place where the TYPE CLASS is present.</strong></li></ol><p name="3267" id="3267" class="graf graf--p graf-after--li">Let’s say you have a type class, defined in the file <code class="markup--code markup--p-code">MyShow.purs</code></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="vbnet" name="fefc" id="fefc" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">module</span> MyShow <span class="hljs-keyword">where</span> <br /><br /><span class="hljs-keyword">class</span> MyShow a <span class="hljs-keyword">where</span> <br />    myShow :: a -&gt; <span class="hljs-type">String</span></span></pre><p name="e59c" id="e59c" class="graf graf--p graf-after--pre">You can create any number of instances for <code class="markup--code markup--p-code">MyShow</code> in <code class="markup--code markup--p-code">MyShow.purs</code> file, as it’s the place where its declared in the first place.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="76a1" id="76a1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">instance myShowInt :: MyShow <span class="hljs-type">Int</span> <span class="hljs-keyword">where</span><br />    myShow a <span class="hljs-operator">=</span> &quot;An Int :&quot; <span class="hljs-operator">&lt;&gt;</span> (<span class="hljs-keyword">show</span> a)<br /><br />instance myShowString :: MyShow String <span class="hljs-keyword">where</span><br />    myShow a <span class="hljs-operator">=</span> &quot;A String :&quot; <span class="hljs-operator">&lt;&gt;</span> a<br /><br /><span class="hljs-comment">--- you can create any instance for `MyShow` here</span></span></pre><p name="e9f6" id="e9f6" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">2. The place where the TYPE is present.</strong></p><p name="aaf0" id="aaf0" class="graf graf--p graf-after--p">Let’s say I have a file <code class="markup--code markup--p-code">Type.purs</code> where I have created a newtype,</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="1867" id="1867" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-type">newtype</span> <span class="hljs-variable">SpecialInt</span> <span class="hljs-operator">=</span> SpecialInt Int </span></pre><p name="cb75" id="cb75" class="graf graf--p graf-after--pre">I can create any instance for <code class="markup--code markup--p-code">SpecialInt</code> in <code class="markup--code markup--p-code">NewFile.purs</code> where the type <code class="markup--code markup--p-code">SpecialInt</code> is actually present.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="65fd" id="65fd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">instance myShowSpecialInt :: MyShow SpecialInt <span class="hljs-keyword">where</span><br />    myShow (SpecialInt a) <span class="hljs-operator">=</span> &quot;A SpecialInt : &quot; <span class="hljs-operator">&lt;&gt;</span> (<span class="hljs-keyword">show</span> a)<br /><br /><span class="hljs-comment">-- you can also create any instance for `SpecialInt` here,</span><br /><span class="hljs-comment">-- e.g Eq, Show etc</span></span></pre><p name="3514" id="3514" class="graf graf--p graf-after--pre">If your type class has more than one parameterized type, like</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="less" name="3a0d" id="3a0d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">MyTypeClass</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span> <span class="hljs-selector-tag">where</span> <br />    <span class="hljs-selector-tag">doSomething</span> :: <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">-</span>&gt; <span class="hljs-selector-tag">b</span> <span class="hljs-selector-tag">-</span>&gt; <span class="hljs-selector-tag">Effect</span> <span class="hljs-selector-tag">Unit</span></span></pre><p name="2a3d" id="2a3d" class="graf graf--p graf-after--pre">Then the instance can be specified in, module where <code class="markup--code markup--p-code">MyTypeClass</code> is present, module where either <code class="markup--code markup--p-code">a</code> or <code class="markup--code markup--p-code">b</code> is present.</p><p name="eb33" id="eb33" class="graf graf--p graf-after--p">So I can edit the above title <em class="markup--em markup--p-em">from</em>,</p><ul class="postList"><li name="0fb2" id="0fb2" class="graf graf--li graf-after--p">The place where the<strong class="markup--strong markup--li-strong"> TYPE is </strong>present</li></ul><p name="7c5c" id="7c5c" class="graf graf--p graf-after--li"><em class="markup--em markup--p-em">to</em>,</p><ul class="postList"><li name="9700" id="9700" class="graf graf--li graf-after--p">The place where the<strong class="markup--strong markup--li-strong"> TYPES are </strong>present</li></ul><p name="1304" id="1304" class="graf graf--p graf-after--li graf--trailing">When functional dependency is present in type class, the rule will become quite complicated. If you’re interested, you can refer <a href="https://liamgoodacre.github.io/purescript/type/class/instance/orphan/functional/dependencies/2017/01/22/purescript-orphan-instance-detection.html" data-href="https://liamgoodacre.github.io/purescript/type/class/instance/orphan/functional/dependencies/2017/01/22/purescript-orphan-instance-detection.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this</a> article written by <a href="https://www.twitter.com/goodacre_liam" data-href="https://www.twitter.com/goodacre_liam" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">LiamGoodCare</a>.</p></div></div></section><section name="c0ac" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="98c8" id="98c8" class="graf graf--h4 graf--leading">But why only two places?</h4><p name="c2dc" id="c2dc" class="graf graf--p graf-after--h4">You may wonder why only two places? Why not everywhere?</p><p name="cf97" id="cf97" class="graf graf--p graf-after--p">What happens when we let developers create any type class instance for any type on anywhere?</p><p name="b595" id="b595" class="graf graf--p graf-after--p">Remember our above <code class="markup--code markup--p-code">MyShow</code> typeclass which is declared in <code class="markup--code markup--p-code">MyShow.purs</code> , where we have defined the instances for <code class="markup--code markup--p-code">Int</code> and <code class="markup--code markup--p-code">String</code> ?</p><p name="f0b5" id="f0b5" class="graf graf--p graf-after--p">What if in a new file <code class="markup--code markup--p-code">MyOtherShow.purs</code> , I do something like,</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="sql" name="b8e7" id="b8e7" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">import MyShow  <span class="hljs-comment">--- the module where our MyShow typeclass is present</span><br /><br />instance myShowInt2 :: MyShow <span class="hljs-type">Int</span> <span class="hljs-keyword">where</span><br />    myShow a <span class="hljs-operator">=</span> &quot;A overlapping Int :&quot; <span class="hljs-operator">&lt;&gt;</span> (<span class="hljs-keyword">show</span> a)</span></pre><p name="014a" id="014a" class="graf graf--p graf-after--pre">By doing the above you just made the compiler go crazy, when you ask for <code class="markup--code markup--p-code">MyShow</code> instance for type <code class="markup--code markup--p-code">Int</code> , which one will the compiler return?</p><p name="ca93" id="ca93" class="graf graf--p graf-after--p">The one(<em class="markup--em markup--p-em">myShowInt</em>) from <code class="markup--code markup--p-code">MyShow.purs</code> or the above one(<em class="markup--em markup--p-em">myShowInt2</em>) from the <code class="markup--code markup--p-code">MyOtherShow.purs</code> ?</p><p name="7d3f" id="7d3f" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Preventing Multiple instances</em></strong> from getting defined is the reason why we have the above rules, otherwise it would be a mess</p><p name="347a" id="347a" class="graf graf--p graf-after--p">So you may ask, if I can declare the instance in any of the two places,</p><ol class="postList"><li name="9b2c" id="9b2c" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">The place where the TYPE CLASS is present.</strong></li><li name="c555" id="c555" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">The place where the TYPES are present.</strong></li></ol><p name="a5d3" id="a5d3" class="graf graf--p graf-after--li">What if I declare same instances on both the places?</p><p name="ba18" id="ba18" class="graf graf--p graf-after--p graf--trailing">E.g, Can I declare instance for <code class="markup--code markup--p-code">MyShow SpecialNumber</code> in both <code class="markup--code markup--p-code">MyShow.purs</code> and <code class="markup--code markup--p-code">Type.purs</code> ? Cyclic dependency😜 says no!!</p></div></div></section><section name="a1a8" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="361a" id="361a" class="graf graf--h4 graf--leading">Orphan Instances</h4><p name="3a3c" id="3a3c" class="graf graf--p graf-after--h4">There is an error you will get if you try to break the above rule, that is, if you try to declare instance anywhere other than the above two places you will get the <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Orphan instance</em></strong> error.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="xml" name="68eb" id="68eb" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">Orphan instance <span class="hljs-tag">&lt;<span class="hljs-name">instance-name</span>&gt;</span> found for<br />                   <br />    <span class="hljs-tag">&lt;<span class="hljs-name">typeclass</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span> </span></pre><p name="2f0d" id="2f0d" class="graf graf--p graf-after--pre graf--trailing">Now, when the above error occurs I hope you know exactly what to do…</p></div></div></section><section name="ea15" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="318c" id="318c" class="graf graf--p graf--leading">Thank you for coming here and reading the article… I would appreciate it more if you share this article with others who may find it helpful like you did🙌.</p><div name="0320" id="0320" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://imsaravananm.medium.com/typeclass-in-purescript-3-behind-the-hood-addcc0091266" data-href="https://imsaravananm.medium.com/typeclass-in-purescript-3-behind-the-hood-addcc0091266" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://imsaravananm.medium.com/typeclass-in-purescript-3-behind-the-hood-addcc0091266"><strong class="markup--strong markup--mixtapeEmbed-strong">TypeClass in Purescript #3 — Behind the hood</strong><br><em class="markup--em markup--mixtapeEmbed-em">Ever wondered how typeclass works behind the hood?</em>imsaravananm.medium.com</a><a href="https://imsaravananm.medium.com/typeclass-in-purescript-3-behind-the-hood-addcc0091266" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6b3f4f5098b23bb60dc36c38a1d63514" data-thumbnail-img-id="1*13xbPrNinkEFCACBS1MA1g.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*13xbPrNinkEFCACBS1MA1g.jpeg);"></a></div><div name="68e6" id="68e6" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://imsaravananm.medium.com/functional-dependencies-understanding-typeclasses-2-5a7826d83c7c" data-href="https://imsaravananm.medium.com/functional-dependencies-understanding-typeclasses-2-5a7826d83c7c" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://imsaravananm.medium.com/functional-dependencies-understanding-typeclasses-2-5a7826d83c7c"><strong class="markup--strong markup--mixtapeEmbed-strong">Functional Dependencies — Understanding Typeclasses #2</strong><br><em class="markup--em markup--mixtapeEmbed-em">If you don’t understand functional dependencies, then you don’t understand type classes.</em>imsaravananm.medium.com</a><a href="https://imsaravananm.medium.com/functional-dependencies-understanding-typeclasses-2-5a7826d83c7c" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6527b06fd66e9fea5278ee52bc764e7f" data-thumbnail-img-id="1*ZGfW3Uic-T2UoLUCNFvyJw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*ZGfW3Uic-T2UoLUCNFvyJw.jpeg);"></a></div><div name="1bdf" id="1bdf" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://imsaravananm.medium.com/introduction-to-type-classes-1-2a7d3be0a70c" data-href="https://imsaravananm.medium.com/introduction-to-type-classes-1-2a7d3be0a70c" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://imsaravananm.medium.com/introduction-to-type-classes-1-2a7d3be0a70c"><strong class="markup--strong markup--mixtapeEmbed-strong">Introduction to Type Classes #1</strong><br><em class="markup--em markup--mixtapeEmbed-em">Let’s understand type classes in functional programming !!</em>imsaravananm.medium.com</a><a href="https://imsaravananm.medium.com/introduction-to-type-classes-1-2a7d3be0a70c" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="49c67e78a7a74c423243d679f1f01707" data-thumbnail-img-id="1*XuRmJB0oN4IdyJMmszauLA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*XuRmJB0oN4IdyJMmszauLA.jpeg);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@imsaravananm" class="p-author h-card">Saravanan M</a> on <a href="https://medium.com/p/412719f66657"><time class="dt-published" datetime="2023-02-06T17:38:53.104Z">February 6, 2023</time></a>.</p><p><a href="https://medium.com/@imsaravananm/where-to-define-typeclass-instances-typeclass-4-412719f66657" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 7, 2023.</p></footer></article></body></html>