<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Stacked Package‚Ää‚Äî‚ÄäBetter Busy and Error Handling</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Stacked Package‚Ää‚Äî‚ÄäBetter Busy and Error Handling</h1>
</header>
<section data-field="subtitle" class="p-summary">
In this article, let‚Äôs see how we can use the stacked package to handle errors and loading states more effectively.
</section>
<section data-field="body" class="e-content">
<section name="47e4" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="cbdd" id="cbdd" class="graf graf--h3 graf--leading graf--title">Stacked Package‚Ää‚Äî‚ÄäBetter Busy and Error¬†Handling</h3><p name="e3f6" id="e3f6" class="graf graf--p graf-after--h3">Have you ever get frustrated by cluttering your UI with so much <strong class="markup--strong markup--p-strong">setstate(), </strong>surely we all have gone through that, at least I did. So I started using bloC. But using <a href="https://pub.dev/packages/flutter_bloc" data-href="https://pub.dev/packages/flutter_bloc" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">bloC </a>sometimes was overkill. So I‚Äôve started using the <a href="https://pub.dev/packages/provider" data-href="https://pub.dev/packages/provider" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">provider</em></a><em class="markup--em markup--p-em"> package </em>which helped me write clean code. But when I want to navigate to another page, show a simple snack bar I still want to pass my build context to the method, which I don‚Äôt like. That‚Äôs when I found an awesome package called <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">stacked</strong></code>, which is built-over <code class="markup--code markup--p-code">ChangeNotifier</code></p><p name="2a11" id="2a11" class="graf graf--p graf-after--p">There are <strong class="markup--strong markup--p-strong">many features available</strong> in the stacked package. In this article, I will tell you how we can <strong class="markup--strong markup--p-strong">handle errors and loading states </strong>more effectively using this package.</p><p name="f2eb" id="f2eb" class="graf graf--p graf-after--p">Let‚Äôs see a simple example of we can implement a simple increment counter using the stacked package.</p><p name="8721" id="8721" class="graf graf--p graf-after--p">First, let‚Äôs see our ViewModel</p><figure name="9983" id="9983" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/65046be8423d792df550f0c6aacb4d1c.js"></script><figcaption class="imageCaption"><strong class="markup--strong markup--figure-strong">BaseViewModel is just an extension of changeNotifier but it provides much more functionality</strong></figcaption></figure><p name="1a45" id="1a45" class="graf graf--p graf-after--figure">There are many subtypes of BaseViewModel like FutureViewModel, ReactiveViewModel, StreamViewModel, and much more. They extend the functionality of the BaseviewModel and reduce much boilerplate code.</p><p name="0e86" id="0e86" class="graf graf--p graf-after--p">Then the below is our simple counter widget(our view).</p><figure name="d074" id="d074" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/6a8934acf400a5e21454ffa1ab5645ee.js"></script></figure><p name="3ee3" id="3ee3" class="graf graf--p graf-after--figure">If you look at the above view(widget), we are wrapping it with <strong class="markup--strong markup--p-strong">ViewModelBuilder</strong>.</p><ol class="postList"><li name="472c" id="472c" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">ViewModelBuilder&lt;T&gt;.reactive()</strong></li></ol><ul class="postList"><li name="eb59" id="eb59" class="graf graf--li graf-after--li">The T will be the type of the ViewModel we want to provide. (<code class="markup--code markup--li-code">CounterViewModel </code>in this case)</li><li name="64e5" id="64e5" class="graf graf--li graf-after--li">The viewModelBuilder takes a callback, that will create an instance of the ViewModel.</li><li name="dfab" id="dfab" class="graf graf--li graf-after--li">Whenever notifyListeners() is called from the ViewModel, the builder will rebuild if it is a <strong class="markup--strong markup--li-strong">ViewModelBuilder.reactive()</strong></li><li name="eba1" id="eba1" class="graf graf--li graf-after--li">There‚Äôs another version called <strong class="markup--strong markup--li-strong">ViewModelBuilder.nonreactive(), </strong>which will not be rebuild when you call notifyListeners().</li></ul><p name="c8b8" id="c8b8" class="graf graf--p graf-after--li">I hope you understand the above code very well since it looks exactly like a changeNotifier code. So what‚Äôs so special about this? Why I‚Äôm exaggerating this package so much? Let‚Äôs see</p><figure name="561b" id="561b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tz7GMzuomveJwAjdjq88bQ.jpeg" data-width="6048" data-height="4024" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*tz7GMzuomveJwAjdjq88bQ.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@mike_van_den_bos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@mike_van_den_bos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Mike van den Bos</a> on¬†<a href="https://unsplash.com/s/photos/loading?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/s/photos/loading?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure><h3 name="bd74" id="bd74" class="graf graf--h3 graf-after--figure"><strong class="markup--strong markup--h3-strong">1.Reduce Loading logic Boiler Plate¬†Code</strong></h3><p name="13cb" id="13cb" class="graf graf--p graf-after--h3">Have you ever written some loading logic like this,</p><figure name="8fd6" id="8fd6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/4f399c31180c45277ec0c11d7662b932.js"></script></figure><p name="df34" id="df34" class="graf graf--p graf-after--figure">Then you have to do in your view something like this,</p><figure name="8145" id="8145" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/5e897404a46e44dece67d70d38538d16.js"></script></figure><h4 name="4b6a" id="4b6a" class="graf graf--h4 graf-after--figure">1. isBusy()</h4><p name="ef53" id="ef53" class="graf graf--p graf-after--h4">But with stacked you can do something like,</p><figure name="cf49" id="cf49" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/23fb4ffe0ed62430c2dbc5fa24d72bc2.js"></script></figure><p name="93ea" id="93ea" class="graf graf--p graf-after--figure">As you can see we are not maintaining any boolean variable for maintaining the loading state. It will be handled for you by the package.</p><figure name="a6ef" id="a6ef" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/ef7c1556d697b7e4f7616bdba55874f3.js"></script></figure><p name="046c" id="046c" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. busy(Object)</strong></p><p name="147e" id="147e" class="graf graf--p graf-after--p">Suppose let‚Äôs say you want to maintain the loading state for separate variables instead of for the whole ViewModel. You can use <code class="markup--code markup--p-code">setBusyForObject()</code>, which will let you set the busy state according to the hashcode of the object passed in.</p><p name="50df" id="50df" class="graf graf--p graf-after--p">Inside the viewModel use setBusyForObject() and pass the object you want to set the busy state and a boolean value representing whether it‚Äôs busy or not.</p><figure name="7e4e" id="7e4e" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/8cc33ca0c3d774f231755b20664a7114.js"></script></figure><p name="a141" id="a141" class="graf graf--p graf-after--figure">Within the view, do something like</p><pre name="bd1e" id="bd1e" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">viewModel.busy(viewModel.post)</strong> <br>             ? LoadingWidget() <br>             : MyWidget(viewModel.post)</pre><p name="5372" id="5372" class="graf graf--p graf-after--pre">This method is very helpful, instead of making the whole view model busy, it just granularly targets a property.</p><blockquote name="69fc" id="69fc" class="graf graf--blockquote graf-after--p">It uses hashcode, if you want to use primitive types, make them <strong class="markup--strong markup--blockquote-strong">final or const</strong></blockquote><pre name="775f" id="775f" class="graf graf--pre graf-after--blockquote">class PostViewModel extends BaseViewModel{<br>   final String initKey = &#39;initialized&#39;;<br>   void init(){<br>      setBusyForObject(initKey,true);<br>      //do initialization<br>      setBusyForObject(initKey,false); <br>  }<br>}</pre><p name="f792" id="f792" class="graf graf--p graf-after--pre">In the UI, you can use the string key to check for busyness,</p><pre name="2ac6" id="2ac6" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">viewModel.busy(viewModel.initKey)</strong> ? LoadingWidget() : MyWidget()</pre><p name="d66e" id="d66e" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">3.anyObjectsBusy</strong></p><ul class="postList"><li name="d0f1" id="d0f1" class="graf graf--li graf-after--p">There‚Äôs also another method to check whether <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">any of the objects is busy</em></strong></li></ul><pre name="b6f4" id="b6f4" class="graf graf--pre graf-after--li"><strong class="markup--strong markup--pre-strong">viewModel.anyObjectsBusy</strong> ? LoadingWidget() : MyWidget()</pre><p name="698c" id="698c" class="graf graf--p graf-after--pre">The above method comes in handy when we are initializing a whole bunch of objects and we want all of them to be initialized before proceeding to show something in the UI.</p><p name="24fc" id="24fc" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">4.runBusyForFuture(Future)</strong></p><p name="ca9d" id="ca9d" class="graf graf--p graf-after--p">If we want to run a long-running task and want to set the busy states automatically according to the completion status of the task we can use runBusyForFuture()</p><figure name="26e2" id="26e2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/eb7ba159adf4f96015269398034ec1c6.js"></script></figure><p name="eac5" id="eac5" class="graf graf--p graf-after--figure">The runBusyFuture will take a Future,</p><ol class="postList"><li name="6541" id="6541" class="graf graf--li graf-after--p">Set Busy state to true for the whole ViewModel or the object you pass in.</li><li name="d970" id="d970" class="graf graf--li graf-after--li">Compute the future.</li><li name="1e35" id="1e35" class="graf graf--li graf-after--li">Set Busy state to false.</li><li name="422f" id="422f" class="graf graf--li graf-after--li">Return the result.</li><li name="ddcb" id="ddcb" class="graf graf--li graf-after--li">Also handles error for you (more on this later)</li></ol><p name="d4bd" id="d4bd" class="graf graf--p graf-after--li">You can also pass an object to set the busy state of that particular object</p><pre name="dc9e" id="dc9e" class="graf graf--pre graf-after--p">void getAllPost() async{<br>   allPosts = await  runBusyFuture(myApiService.getAllPosts(),<strong class="markup--strong markup--pre-strong">busyObject:allPosts</strong>);<br>   notifyListeners();<br>}</pre><p name="2065" id="2065" class="graf graf--p graf-after--pre">You can also pass a string to the <code class="markup--code markup--p-code">busyObject</code>,</p><pre name="03f5" id="03f5" class="graf graf--pre graf-after--p">void updateItem(int id) async{<br>   <strong class="markup--strong markup--pre-strong">String updateKey = &#39;$id update-key&#39;;</strong><br>  _post = await runBusyFuture(<br>          myApiService.fetchPost(id),<strong class="markup--strong markup--pre-strong">busyObject: </strong>updateKey);<br>   notifyListeners();<br>}</pre><p name="bb8c" id="bb8c" class="graf graf--p graf-after--pre">Then you can use it in the UI like,</p><pre name="d7aa" id="d7aa" class="graf graf--pre graf-after--p graf--trailing">viewModel.busy(&#39;$id update-key&#39;) ? LoadingWidget() : MyWidget(id)</pre></div></div></section><section name="55bd" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="8ef5" id="8ef5" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*EfKPwQM0KpHlr2B9_ZPaAQ.jpeg" data-width="4000" data-height="2800" src="https://cdn-images-1.medium.com/max/800/1*EfKPwQM0KpHlr2B9_ZPaAQ.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@visuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@visuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">visuals</a> on¬†<a href="https://unsplash.com/s/photos/error?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/s/photos/error?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure><h3 name="e21e" id="e21e" class="graf graf--h3 graf-after--figure">2. Error Handling Made¬†Simple</h3><p name="d055" id="d055" class="graf graf--p graf-after--h3">Similar to busy handling, we can handle the errors using the <code class="markup--code markup--p-code">stacked </code>package easily. It does everything for us and we can access them in the UI and show widgets accordingly.</p><ol class="postList"><li name="b203" id="b203" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">setError(error)</strong></li></ol><p name="4bfb" id="4bfb" class="graf graf--p graf-after--li">Using this method you can set the error for the whole ViewModel.</p><pre name="42d7" id="42d7" class="graf graf--pre graf-after--p">setError(‚Äòsomething went wrong‚Äô)</pre><p name="29f1" id="29f1" class="graf graf--p graf-after--pre">And access it in the UI using,</p><pre name="c7c7" id="c7c7" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">viewModel.hasError</strong> <br>        ? Text(<strong class="markup--strong markup--pre-strong">viewModel.error(viewModel)</strong>)//&#39;something went wrong&#39;<br>        : Text(‚Äòsuccess‚Äô)</pre><ol class="postList"><li name="9389" id="9389" class="graf graf--li graf-after--pre"><code class="markup--code markup--li-code">ViewModel.hasError</code> tells whether there‚Äôs an error in our ViewModel.</li><li name="b8ec" id="b8ec" class="graf graf--li graf-after--li graf--trailing"><code class="markup--code markup--li-code">viewModel.error(object)</code>, here we have passed the viewModel itself, so it will fetch the error in our ViewModel.</li></ol></div></div></section><section name="980f" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="a407" id="a407" class="graf graf--h4 graf--leading">2. setErrorForObject(object,error)</h4><p name="12a9" id="12a9" class="graf graf--p graf-after--h4">Using this method, you can set an error for a particular object or key and access it in your UI.</p><figure name="8d61" id="8d61" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/2183b7ffd3d2c88e9c7023d425ac186c.js"></script></figure><p name="c448" id="c448" class="graf graf--p graf-after--figure">The try block will raise an error after 3 seconds, it will be caught by the below catch block. Inside it, we are setting the error for the object <code class="markup--code markup--p-code">_post,</code> with the exception string as the value of the error.</p><p name="945e" id="945e" class="graf graf--p graf-after--p">We can check for the error inside the UI by,</p><pre name="fdea" id="fdea" class="graf graf--pre graf-after--p">SomeWidget(<br>child: <strong class="markup--strong markup--pre-strong">viewModel.hasErrorForKey(viewModel.post)</strong><br>            ? Text(<strong class="markup--strong markup--pre-strong">viewModel.error(viewModel.post)</strong>)<br>            : Text(&quot;success&quot;)),<br>);</pre><p name="9876" id="9876" class="graf graf--p graf-after--pre">This is how we can access the error inside the UI.</p><p name="9c39" id="9c39" class="graf graf--p graf-after--p">As I have already told <strong class="markup--strong markup--p-strong">runBusyFuture()</strong> handles the error for us,</p><p name="5f0a" id="5f0a" class="graf graf--p graf-after--p">Syntax:</p><pre name="f68b" id="f68b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">Future&lt;T&gt; runBusyFuture&lt;T&gt;(<br>        Future&lt;T&gt; busyFuture,<br>       {Object? busyObject,<br>        bool throwException = false})</code></pre><blockquote name="2675" id="2675" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">busyFuture</strong>: it‚Äôs the future we want to execute</blockquote><blockquote name="db57" id="db57" class="graf graf--blockquote graf-after--blockquote"><strong class="markup--strong markup--blockquote-strong">busyObject</strong>: This one is optional. If we pass an object, its hashcode is used as the key for setting the error or busy state.</blockquote><blockquote name="fe81" id="fe81" class="graf graf--blockquote graf-after--blockquote"><strong class="markup--strong markup--blockquote-strong">throwException</strong>: runBusyFuture doesn‚Äôt throw an error by default, if an error occurs, it will only set the error state. We can override the behaviour and throw an error by setting <code class="markup--code markup--blockquote-code">throwException=true</code></blockquote><p name="6f75" id="6f75" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">runErrorFuture()</strong></p><p name="ff49" id="ff49" class="graf graf--p graf-after--p graf--trailing">Sometimes you don‚Äôt want to handle any busyness(busy-nessüòÇ not business) logic and still want to run a future that may raise an error. On that occasion, you can use <strong class="markup--strong markup--p-strong">runErrorFuture(). </strong>It works like, <code class="markup--code markup--p-code">runBusyFuture()</code>but it doesn&#39;t handle any busyness logic. Moreover <strong class="markup--strong markup--p-strong">runBusyFuture() is built using runErrorFuture().</strong></p></div></div></section><section name="60e9" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="72d5" id="72d5" class="graf graf--h3 graf--leading">3. Handling Future‚Ää‚Äî‚ÄäFutureViewModel</h3><p name="5b0d" id="5b0d" class="graf graf--p graf-after--h3">Sometimes we may want to initialize data from a future, so we use FutureBuilder, the stacked package also has some cool features to initiate data from a future and <strong class="markup--strong markup--p-strong">handle the lifecycle of the future</strong>. The FutureViewModel help us to leverage the power of the BaseViewModel with the <em class="markup--em markup--p-em">feature </em>I specified above.</p><ul class="postList"><li name="bb68" id="bb68" class="graf graf--li graf-after--p">You just want to override the method <strong class="markup--strong markup--li-strong">futureToRun(), </strong>which will initiate the data from the future for you and save it in a property called <strong class="markup--strong markup--li-strong">data</strong>.</li></ul><figure name="f888" id="f888" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/imsaravana369/c09a4b9e61acee2c3d198a079479e42c.js"></script></figure><p name="c714" id="c714" class="graf graf--p graf-after--figure">What the method does is,</p><ul class="postList"><li name="2cce" id="2cce" class="graf graf--li graf-after--p">It will run the futureToRun() when you create the FutureViewModel Object.</li><li name="ed05" id="ed05" class="graf graf--li graf-after--li">It will call <code class="markup--code markup--li-code">setBusy(true)</code></li><li name="67ce" id="67ce" class="graf graf--li graf-after--li">Once the computation is done, then you can access the data using <code class="markup--code markup--li-code">viewModel.data</code></li><li name="7d72" id="7d72" class="graf graf--li graf-after--li">If it results in failure, it will set the error state of the ViewModel.</li><li name="9928" id="9928" class="graf graf--li graf-after--li">Finally, it will call <code class="markup--code markup--li-code">setBusy(false)</code></li></ul><p name="a906" id="a906" class="graf graf--p graf-after--li">What we can do with this?</p><ul class="postList"><li name="5489" id="5489" class="graf graf--li graf-after--p">We can check if the data is ready by using <code class="markup--code markup--li-code">viewModel.dataReady</code></li><li name="2e30" id="2e30" class="graf graf--li graf-after--li">We can fetch the data using <code class="markup--code markup--li-code">viewModel.data</code></li></ul><pre name="9854" id="9854" class="graf graf--pre graf-after--li">Center(<br>  child: ViewModelBuilder&lt;PostViewModel&gt;.reactive(<br>    viewModelBuilder: () =&gt; PostViewModel(),<br>     builder: (ctx, viewModel, _) =&gt; <br>        <strong class="markup--strong markup--pre-strong">viewModel.hasError</strong><br>        ? Text(&#39;Something went wrong&#39;)<br>        : <strong class="markup--strong markup--pre-strong">viewModel.dataReady</strong><br>            ? MyListItem(viewModel.data)<br>            : CircularProgressIndicator(),<br>  ),<br>)</pre><h4 name="3374" id="3374" class="graf graf--h4 graf-after--pre"><strong class="markup--strong markup--h4-strong">onData()</strong></h4><p name="4bc2" id="4bc2" class="graf graf--p graf-after--h4">If you want to assign the fetched data to some variable, you can override one of the hooks <strong class="markup--strong markup--p-strong">onData(data).</strong></p><pre name="a236" id="a236" class="graf graf--pre graf-after--p">class PostViewModel extends FutureViewModel {<br>  <strong class="markup--strong markup--pre-strong">List&lt;Post&gt; allPosts;</strong><br>  @override<br>  Future futureToRun() async {<br>     //your future<br>  }</pre><pre name="c953" id="c953" class="graf graf--pre graf-after--pre">@override<br><strong class="markup--strong markup--pre-strong">  void onData(data) {   //called once the data is ready<br>    allPosts = data;<br>    super.onData(data);<br>  }</strong><br> }</pre><p name="9bc4" id="9bc4" class="graf graf--p graf-after--pre">Now you can access the same data using <em class="markup--em markup--p-em">allPosts variable</em>, you can do any kind of operations inside the onData like filtering the data, caching, etc.</p><h4 name="a8d6" id="a8d6" class="graf graf--h4 graf-after--p">onError()</h4><p name="0c57" id="0c57" class="graf graf--p graf-after--h4">What if you want to assign some default value when an error has occurred in your futureToRun()? You can override the onError() hook.</p><pre name="222a" id="222a" class="graf graf--pre graf-after--p">@override<br>void onError(error) { <br>  <strong class="markup--strong markup--pre-strong">onData(someDefaultData);<em class="markup--em markup--pre-em"><br></em></strong><em class="markup--em markup--pre-em">  </em>super.onError(error);<br>}</pre><p name="650f" id="650f" class="graf graf--p graf-after--pre">In the above code, I‚Äôm setting some default values as my ‚Äòdata‚Äô when an error occurs. Now we can access that default data using <code class="markup--code markup--p-code">viewModel.data</code></p><blockquote name="d65d" id="d65d" class="graf graf--blockquote graf-after--p">Don‚Äôt call <code class="markup--code markup--blockquote-code">futureToRun()</code> again inside the onError()¬†, it may cause an endless loop.</blockquote><p name="052c" id="052c" class="graf graf--p graf-after--blockquote graf--trailing">Currently, there‚Äôs no retry functionality but I hope they will add it soon.</p></div></div></section><section name="eda1" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="f99c" id="f99c" class="graf graf--p graf--leading">Hope you‚Äôve learned how the <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">stacked </em></strong><em class="markup--em markup--p-em">package </em>reduces much of the boilerplate code and helps us easily handle errors and loading states.</p><p name="25bf" id="25bf" class="graf graf--p graf-after--p graf--trailing">In my <a href="https://medium.com/nerd-for-tech/stacked-package-service-location-routing-logging-b8bdc1e6c839" data-href="https://medium.com/nerd-for-tech/stacked-package-service-location-routing-logging-b8bdc1e6c839" class="markup--anchor markup--p-anchor" target="_blank">next article</a>, I will write about the services provided by this package, like service location, Routing, Logging. Thank you for readingüòª, Clapüëè if you‚Äôve liked this article.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@imsaravananm" class="p-author h-card">Saravanan M</a> on <a href="https://medium.com/p/643b0131f0a6"><time class="dt-published" datetime="2021-07-19T01:30:25.491Z">July 19, 2021</time></a>.</p><p><a href="https://medium.com/@imsaravananm/stacked-package-better-busy-and-error-handling-643b0131f0a6" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 7, 2023.</p></footer></article></body></html>