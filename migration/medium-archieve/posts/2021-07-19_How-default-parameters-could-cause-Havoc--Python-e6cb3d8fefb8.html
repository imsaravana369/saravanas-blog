<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How default parameters could cause Havoc— Python</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How default parameters could cause Havoc— Python</h1>
</header>
<section data-field="subtitle" class="p-summary">
Be Cautious while using default parameters.
</section>
<section data-field="body" class="e-content">
<section name="5f6f" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="f0f2" id="f0f2" class="graf graf--h3 graf--leading graf--title">How default parameters could cause Havoc— Python</h3><p name="7bd4" id="7bd4" class="graf graf--p graf-after--h3">This article is something I write from my personal experience. Many a time I got stuck for hours because of the strange behavior of default parameters in python. That’s what I’m going to share in this article.</p><h4 name="361b" id="361b" class="graf graf--h4 graf-after--p">What are Default parameters?</h4><p name="2906" id="2906" class="graf graf--p graf-after--h4">Default parameters are parameters with a default value, which are optional to pass while calling the function. If the function is called without the argument, the argument will be assigned the default value.</p><pre name="0a32" id="0a32" class="graf graf--pre graf-after--p">def callPerson(name=&#39;guest&#39;):<br> print(f&#39;hello {name}&#39;)</pre><p name="6a37" id="6a37" class="graf graf--p graf-after--pre">If you invoke the function,</p><pre name="a76e" id="a76e" class="graf graf--pre graf-after--p">&gt;&gt; callPerson(&#39;saravana&#39;) #  hello saravana</pre><pre name="bb55" id="bb55" class="graf graf--pre graf-after--pre">&gt;&gt; <strong class="markup--strong markup--pre-strong">callPerson() #  hello guest</strong></pre><p name="a453" id="a453" class="graf graf--p graf-after--pre">This is how the default argument works,</p><ul class="postList"><li name="1c80" id="1c80" class="graf graf--li graf-after--p">You pass it a value, it whole-heartedly accepts and uses that.</li><li name="8adf" id="8adf" class="graf graf--li graf-after--li graf--trailing">If you don&#39;t pass any value, it doesn’t complain, it uses the value it has.</li></ul></div></div></section><section name="1165" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="cf77" id="cf77" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*KpfR6fnFnClOYPEiu1IojQ.jpeg" data-width="6000" data-height="4000" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*KpfR6fnFnClOYPEiu1IojQ.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@messrro?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@messrro?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Mehdi</a> on <a href="https://unsplash.com/s/photos/bomb?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/s/photos/bomb?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure><p name="e94f" id="e94f" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Then what’s the problem with default arguments?</strong></p><p name="ab49" id="ab49" class="graf graf--p graf-after--p">Default arguments don’t have any problems of their own. It’s when it is assigned a <strong class="markup--strong markup--p-strong">mutable object like</strong> a <strong class="markup--strong markup--p-strong">list, dictionary, set,</strong> or any <strong class="markup--strong markup--p-strong">user-defined class.</strong></p><blockquote name="3af8" id="3af8" class="graf graf--pullquote graf-after--p">Using Mutable objects as default argument values may cause Havoc</blockquote><p name="104d" id="104d" class="graf graf--p graf-after--pullquote">As you know, mutable objects can change, mutate.</p><pre name="f7a1" id="f7a1" class="graf graf--pre graf-after--p">myList = [1,2,3]  # list - mutable<br>myList[0] = 10    # Fine✌</pre><pre name="16d8" id="16d8" class="graf graf--pre graf-after--pre">myTuple = (1,2,3) # tuple- immutable<br><strong class="markup--strong markup--pre-strong">myTuple[0] = 10   # ERROR🚫</strong></pre><p name="13ab" id="13ab" class="graf graf--p graf-after--pre">Now let’s see why mutable objects shouldn’t be used in default arguments.</p><p name="c877" id="c877" class="graf graf--p graf-after--p">Let’s start with an example.</p><pre name="bc7e" id="bc7e" class="graf graf--pre graf-after--p">&gt;&gt;&gt; def buyStuff(item,<strong class="markup--strong markup--pre-strong">alreadyBought=[]</strong>):<br>          alreadyBought.append(item)<br>          print(&#39;You bought &#39;,alreadyBought)</pre><pre name="bc4f" id="bc4f" class="graf graf--pre graf-after--pre">&gt;&gt;&gt; buyStuff(&#39;apple&#39;,[&#39;mango&#39;,&#39;jackfruit&#39;])<br>You bought  [&#39;mango&#39;, &#39;jackfruit&#39;, &#39;apple&#39;]   #fine</pre><pre name="69b8" id="69b8" class="graf graf--pre graf-after--pre">&gt;&gt;&gt; buyStuff(&#39;apple&#39;)<br>You bought  [&#39;apple&#39;]                         #this is also fine</pre><pre name="d7bb" id="d7bb" class="graf graf--pre graf-after--pre">&gt;<strong class="markup--strong markup--pre-strong">&gt;&gt; buyStuff(&#39;apple&#39;)<br>You bought  [&#39;apple&#39;, &#39;apple&#39;]</strong>           #Wait, free apple?</pre><p name="8419" id="8419" class="graf graf--p graf-after--pre">We just wanted one apple, but we have been given two apples and there’s not <code class="markup--code markup--p-code">any buy one🍎 get one🍏</code> offer either🤔</p><p name="5d25" id="5d25" class="graf graf--p graf-after--p">To understand why this has happened? we have to first understand how default arguments work.</p><blockquote name="e8b3" id="e8b3" class="graf graf--pullquote graf-after--p">Python’s default arguments are evaluated <em class="markup--em markup--pullquote-em">once</em> when the function is defined, not each time the function is called</blockquote><ul class="postList"><li name="2993" id="2993" class="graf graf--li graf-after--pullquote">The first time you define the function with <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">alreadyBought=[] </strong></code>The <code class="markup--code markup--li-code">alreadyBought </code>variable start pointing to an empty list.</li></ul><figure name="c4d3" id="c4d3" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*CkH7FRqVNlcMXoUuUuSxFQ.png" data-width="901" data-height="476" src="https://cdn-images-1.medium.com/max/800/1*CkH7FRqVNlcMXoUuUuSxFQ.png"><figcaption class="imageCaption">alreadyBought variable pointing to an empty List</figcaption></figure><ul class="postList"><li name="2868" id="2868" class="graf graf--li graf-after--figure">When you append data to it. It will become,</li></ul><figure name="9eb5" id="9eb5" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*OyHBo1Z6OQqajVxMOph5aA.png" data-width="861" data-height="442" src="https://cdn-images-1.medium.com/max/800/1*OyHBo1Z6OQqajVxMOph5aA.png"><figcaption class="imageCaption">After appending an element to the list.</figcaption></figure><ul class="postList"><li name="3cd8" id="3cd8" class="graf graf--li graf-after--figure">Since the <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">alreadyBought variable always points to that list</em></strong>, the same list is reused every time, that is why we are getting that strange behavior.</li></ul><h4 name="9a7b" id="9a7b" class="graf graf--h4 graf-after--li">How to avoid this?</h4><ol class="postList"><li name="aa54" id="aa54" class="graf graf--li graf-after--h4">Try to replace the mutable objects with corresponding immutable ones.</li></ol><pre name="bccb" id="bccb" class="graf graf--pre graf-after--li">list() -&gt; <strong class="markup--strong markup--pre-strong">tuple()</strong><br>set()  -&gt; <strong class="markup--strong markup--pre-strong">frozenset()<br></strong>dict() -&gt; <a href="https://pypi.org/project/frozendict/" data-href="https://pypi.org/project/frozendict/" class="markup--anchor markup--pre-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">frozendict(</strong></a><strong class="markup--strong markup--pre-strong">)</strong></pre><p name="df81" id="df81" class="graf graf--p graf-after--pre">2. But the above method is not always preferable. What if we really want to have a mutable one?</p><p name="8fab" id="8fab" class="graf graf--p graf-after--p">The safest thing we can do is to assign <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">None </strong></code>to the default argument in the function definition and assign mutable value to it within the function.</p><pre name="0499" id="0499" class="graf graf--pre graf-after--p">&gt;&gt; def buyStuff(item,alreadyBought=None):<br>      <strong class="markup--strong markup--pre-strong">if not alreadyBought:<br>           alreadyBought = []</strong><br>      alreadyBought.append(item)<br>      print(‘You bought ‘,alreadyBought)</pre><pre name="637f" id="637f" class="graf graf--pre graf-after--pre">&gt;&gt;&gt; buyStuff(‘apple’)<br><strong class="markup--strong markup--pre-strong">You bought [‘apple’]<br></strong>&gt;&gt;&gt; buyStuff(‘apple’)<br><strong class="markup--strong markup--pre-strong">You bought [‘apple’]</strong></pre><p name="3eee" id="3eee" class="graf graf--p graf-after--pre">Now each time we call the function without <code class="markup--code markup--p-code">alreadyBought </code>argument, we will assign an empty list to it, explicitly within the function. But the sad thing is we’ve received only one apple🍎 ☹.</p><h4 name="239e" id="239e" class="graf graf--h4 graf-after--p">Everyone in the world is blessed!!</h4><p name="5893" id="5893" class="graf graf--p graf-after--h4">Mutable objects in the default arguments are not an exception for the saying. We can <strong class="markup--strong markup--p-strong">take advantage</strong> of the strange behavior(not strange anymore) in some cases.</p><blockquote name="a484" id="a484" class="graf graf--blockquote graf--hasDropCapModel graf-after--p">Sometimes you can specifically “exploit” (read: use as intended) this behavior to maintain state between calls of a function. This is often done when writing a caching function. — <a href="https://docs.python-guide.org/writing/gotchas/" data-href="https://docs.python-guide.org/writing/gotchas/" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">docs</a></blockquote><pre name="01ca" id="01ca" class="graf graf--pre graf-after--blockquote"># ith fibbonaci number using dynamic programming</pre><pre name="bbde" id="bbde" class="graf graf--pre graf-after--pre">def fibbonaci(i,<strong class="markup--strong markup--pre-strong">memo={0:0,1:1}</strong>):<br> if memo.get(i)!=None:<br>       return memo[i]<br> memo[i] = fibbonaci(i-1)+fibbonaci(i-2)<br> return memo[i]</pre><p name="a625" id="a625" class="graf graf--p graf-after--pre graf--trailing">As you can see we don’t want to pass the <code class="markup--code markup--p-code">memo</code> dictionary in each call, it is maintained for us in the default argument.</p></div></div></section><section name="18e6" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="9ef5" id="9ef5" class="graf graf--p graf--leading graf--trailing">I hope the next time you know, what to do when you get that <code class="markup--code markup--p-code"><em class="markup--em markup--p-em">extra apple🍏</em></code>.Thank you for reading. Clap👏 if you’ve learned something new. If you want to know more, give this <a href="https://docs.python-guide.org/writing/gotchas/" data-href="https://docs.python-guide.org/writing/gotchas/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">article </a>a read.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@imsaravananm" class="p-author h-card">Saravanan M</a> on <a href="https://medium.com/p/e6cb3d8fefb8"><time class="dt-published" datetime="2021-07-19T18:47:56.304Z">July 19, 2021</time></a>.</p><p><a href="https://medium.com/@imsaravananm/how-default-parameters-could-cause-havoc-python-e6cb3d8fefb8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 7, 2023.</p></footer></article></body></html>