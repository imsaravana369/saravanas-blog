<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Implement Service Locator design pattern with get_it — Flutter</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Implement Service Locator design pattern with get_it — Flutter</h1>
</header>
<section data-field="subtitle" class="p-summary">
In this article, we are going to see how we can implement a service locator design pattern with the get_it package in flutter.
</section>
<section data-field="body" class="e-content">
<section name="a05f" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="4871" id="4871" class="graf graf--h3 graf--leading graf--title">Implement Service Locator design pattern with get_it — Flutter</h3><p name="0a5f" id="0a5f" class="graf graf--p graf-after--h3">In this article, we are going to see how we can implement a service locator design pattern with the get_it package in flutter.</p><figure name="e67f" id="e67f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1YELyT2GMkFHv5eeywReMQ.jpeg" data-width="3500" data-height="2333" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*1YELyT2GMkFHv5eeywReMQ.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Markus Spiske</a> on <a href="https://unsplash.com/s/photos/dependency-injection?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/s/photos/dependency-injection?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure><h3 name="30bd" id="30bd" class="graf graf--h3 graf-after--figure">Service Locator design pattern</h3><p name="8cbf" id="8cbf" class="graf graf--p graf-after--h3">In a service locator design pattern, we maintain a central registry that provides instances of services when they are requested by the service consumers or the service clients. It is very similar to dependency injection but they are not the same.</p><p name="c324" id="c324" class="graf graf--p graf-after--p">If you don’t understand the design pattern, I’m sure you will understand it after reading this article.</p><h3 name="2893" id="2893" class="graf graf--h3 graf-after--p">Why we need these?</h3><p name="336b" id="336b" class="graf graf--p graf-after--h3">we don’t do something new unless there were some faults in how we did that before. Let’s see why we are going for design patterns like service locator or dependency injection.</p><p name="6ae9" id="6ae9" class="graf graf--p graf-after--p">Let’s start with an example,</p><p name="3469" id="3469" class="graf graf--p graf-after--p">We want to create a custom Logger for our application, let’s create an interface for it.</p><pre name="bde6" id="bde6" class="graf graf--pre graf-after--p">abstract class Logger{<br>  void log(String msg);<br>}</pre><p name="2b50" id="2b50" class="graf graf--p graf-after--pre">Let’s say we want to create two implementations, a simple console logger and a file logger.</p><ul class="postList"><li name="1885" id="1885" class="graf graf--li graf-after--p">ConsolerLogger</li></ul><figure name="ff00" id="ff00" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/imsaravana369/d564fd026aad4a759ce519427a1cb6e6.js"></script></figure><ul class="postList"><li name="b97b" id="b97b" class="graf graf--li graf-after--figure">FileLogger</li></ul><figure name="230a" id="230a" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/imsaravana369/7c2f1bba9032e5f81519acf0eaf21a76.js"></script></figure><p name="0d22" id="0d22" class="graf graf--p graf-after--figure">If you want to use that in your flutter application, what would you do?</p><ol class="postList"><li name="0538" id="0538" class="graf graf--li graf-after--p">Create an instance of what Logger you want.</li><li name="ada6" id="ada6" class="graf graf--li graf-after--li">Just pass the message to be logged to the log() function.</li></ol><pre name="8883" id="8883" class="graf graf--pre graf-after--li">void main(){<br>  Logger myLogger = ConsoleLogger();<br>  //Logger myLogger = FileLogger();<br>  myLogger.log(&#39;file accessed&#39;);<br>}</pre><p name="f798" id="f798" class="graf graf--p graf-after--pre">What’s wrong with the approach?</p><ul class="postList"><li name="014c" id="014c" class="graf graf--li graf-after--p">The calling method/class, main() in this case, has to create the instance of Logger class which is not good. What if you want to have the instance at multiple classes? You have to instantiate the method everywhere by yourself.</li><li name="641c" id="641c" class="graf graf--li graf-after--li">You may say, okay I will declare it as a singleton. Problem solved! No, that’s not enough! Because it will be really hard to unit test singletons and many times you don’t want singletons.</li></ul><figure name="cd8c" id="cd8c" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/imsaravana369/9488cfddf1c708e724e10917b704dc24.js"></script><figcaption class="imageCaption">There’s no way we can mock ConsoleLogger class.</figcaption></figure><ul class="postList"><li name="796a" id="796a" class="graf graf--li graf-after--figure">You can provide the objects through inherited widgets or using Providers but it will become very cumbersome and also you can’t access the objects outside your UI without passing the buildContext.</li></ul><p name="4402" id="4402" class="graf graf--p graf-after--li">So how we can overcome the below problems,</p><ol class="postList"><li name="2213" id="2213" class="graf graf--li graf-after--p">Hide the instance creation from client classes.</li><li name="d0bd" id="d0bd" class="graf graf--li graf-after--li">Make unit testing easy.</li><li name="6786" id="6786" class="graf graf--li graf-after--li">Avoid cluttering the UI tree with special Widgets to access your data as the provider or Redux does.</li></ol><p name="41e4" id="41e4" class="graf graf--p graf-after--li graf--trailing"><strong class="markup--strong markup--p-strong">We can use the get_it package</strong></p></div></div></section><section name="6831" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="2794" id="2794" class="graf graf--h4 graf--leading">get_it Package</h4><p name="1244" id="1244" class="graf graf--p graf-after--h4">Add get_it to your pubspec.yaml file,</p><pre name="b82b" id="b82b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">dependencies:<br>  <strong class="markup--strong markup--pre-strong">get_it: ^7.1.4</strong></code></pre><p name="7d9f" id="7d9f" class="graf graf--p graf-after--pre">As I mentioned, before</p><p name="e7f2" id="e7f2" class="graf graf--p graf-after--p">In a service locator design pattern, we maintain a <strong class="markup--strong markup--p-strong">central registry</strong> that provides an implementation of different interfaces. It is very similar to dependency injection but they are not the same.</p><p name="01af" id="01af" class="graf graf--p graf-after--p">We will be registering all the instances under one method and call the instance from main() before calling runApp() to make sure every instance is registered before the app starts,</p><p name="999d" id="999d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">locator.dart</strong></p><pre name="824b" id="824b" class="graf graf--pre graf-after--p">import &#39;package:get_it/get_it.dart&#39;;</pre><pre name="bb5c" id="bb5c" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">final serviceLocator = GetIt.instance</strong>; // GetIt.I is also valid<br>void <strong class="markup--strong markup--pre-strong">setUp()</strong>{<br> serviceLocator.registerLazySingleton&lt;Logger&gt;(<br>               () =&gt; ConsoleLogger());<br> serviceLocator.registerSingleton&lt;Model&gt;(()=&gt; MyModel());<br> // register more instances<br>}</pre><p name="efe4" id="efe4" class="graf graf--p graf-after--pre">We are declaring the serviceLocator instance globally so that we can access it anywhere in the application. Here the <strong class="markup--strong markup--p-strong">central Registery is the GetIt.instance, </strong>which holds all the registered instances.</p><p name="5f28" id="5f28" class="graf graf--p graf-after--p">The setUp() (or any name of your choice) method is the place where we register all our instances.</p><pre name="3a35" id="3a35" class="graf graf--pre graf-after--p">void main(){<br>     <strong class="markup--strong markup--pre-strong">setUp();</strong> //call this method before runApp()<br>     runApp(MyApp());<br>}</pre><p name="f5bd" id="f5bd" class="graf graf--p graf-after--pre">To get the registered instance use get&lt;T&gt;() method</p><pre name="35b2" id="35b2" class="graf graf--pre graf-after--p">Logger logger = serviceLocator.<strong class="markup--strong markup--pre-strong">get&lt;Logger&gt;()</strong>;   </pre><p name="dcde" id="dcde" class="graf graf--p graf-after--pre">get_it provides various methods to register the instances. Let’s look at them one by one.</p><h4 name="b784" id="b784" class="graf graf--h4 graf-after--p">Different ways of Registration</h4><h4 name="0c37" id="0c37" class="graf graf--h4 graf-after--h4">1.registerSingleton(T instance)</h4><p name="670d" id="670d" class="graf graf--p graf-after--h4">We use this method to register a singleton instance(one instance is created and the same instance is returned whenever we call get&lt;T&gt;()).</p><pre name="f906" id="f906" class="graf graf--pre graf-after--p">serviceLocator.<strong class="markup--strong markup--pre-strong">registerSingleton</strong>&lt;Model&gt;(MyModel());</pre><h4 name="ee05" id="ee05" class="graf graf--h4 graf-after--pre">2.registerLazySingleton(FactoryFunc&lt;T&gt; factoryFunc)</h4><p name="0359" id="0359" class="graf graf--p graf-after--h4">This method is also used to register a singleton instance but it does that lazily, the object is instantiated only when get&lt;T&gt;() is called the first time, whereas the registerSingleton method instantiates the instance when the setUp() method is called and make the instance readily available.</p><pre name="dbc6" id="dbc6" class="graf graf--pre graf-after--p">serviceLocator.<strong class="markup--strong markup--pre-strong">registerLazySingleton</strong>&lt;Model&gt;(()=&gt;MyModel());</pre><h4 name="e4c4" id="e4c4" class="graf graf--h4 graf-after--pre">3.registerFactory(FactoryFunc&lt;T&gt; factoryFunc)</h4><p name="f87e" id="f87e" class="graf graf--p graf-after--h4">We use this method to return a <strong class="markup--strong markup--p-strong">new instance of type T every time</strong> we call get&lt;T&gt;()</p><pre name="4246" id="4246" class="graf graf--pre graf-after--p">serviceLocator.<strong class="markup--strong markup--pre-strong">registerFactory</strong>&lt;Model&gt;(()=&gt;MyModel());</pre><p name="e2ad" id="e2ad" class="graf graf--p graf-after--pre">Remember that you can’t pass any parameters to the Constructor dynamically using registerFactory().</p><p name="1f04" id="1f04" class="graf graf--p graf-after--p">Suppose let’s say your MyModel() class takes a parameter,</p><pre name="25a9" id="25a9" class="graf graf--pre graf-after--p">class MyModel{<br>     String name;<br>     MyModel(this.name);<br>}</pre><p name="b118" id="b118" class="graf graf--p graf-after--pre">How can you register this instance in get_it?</p><h4 name="213a" id="213a" class="graf graf--h4 graf-after--p">4.registerFactoryParam(FactoryFunc&lt;T<code class="markup--code markup--h4-code">,P1,P2</code>&gt; factoryFunc)</h4><p name="0957" id="0957" class="graf graf--p graf-after--h4">Using this method we can instantiate instances that take at most 2 parameters in their constructor.</p><p name="2966" id="2966" class="graf graf--p graf-after--p">Consider this model class,</p><pre name="112e" id="112e" class="graf graf--pre graf-after--p">class Person{<br>     String name;<br>     int age;<br>     <strong class="markup--strong markup--pre-strong">MyModel(this.name,this.age);</strong><br>}</pre><p name="8953" id="8953" class="graf graf--p graf-after--pre">You can register an instance of Person class using,</p><pre name="b2c1" id="b2c1" class="graf graf--pre graf-after--p">serviceLocator<br>  .<strong class="markup--strong markup--pre-strong">registerFactoryParam&lt;Person,String,int&gt;</strong><br>   ((name, age) =&gt; Person(name,age));</pre><blockquote name="bf41" id="bf41" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">registerFactoryParam&lt;Type,Param1,Param2&gt;</strong></blockquote><blockquote name="4c12" id="4c12" class="graf graf--blockquote graf-after--blockquote">Type: The type of the class to be registered</blockquote><blockquote name="41c3" id="41c3" class="graf graf--blockquote graf-after--blockquote">Param1: The type of the 1st parameter</blockquote><blockquote name="5e48" id="5e48" class="graf graf--blockquote graf-after--blockquote">Param2: The type of the 2nd parameter</blockquote><p name="0ae4" id="0ae4" class="graf graf--p graf-after--blockquote">To get the instance,</p><pre name="e45c" id="e45c" class="graf graf--pre graf-after--p">var logger = serviceLocator.get&lt;Person&gt;<strong class="markup--strong markup--pre-strong">(param1:&#39;user&#39;,param2: 20)</strong>;</pre><p name="fe53" id="fe53" class="graf graf--p graf-after--pre">If you want only one instance, set <strong class="markup--strong markup--p-strong">void </strong>to the second param</p><pre name="cbc8" id="cbc8" class="graf graf--pre graf-after--p">serviceLocator<br>  .registerFactoryParam&lt;MyModel,String,void&gt;<br>   ((name, _) =&gt; MyModel(name,20));</pre><p name="6298" id="6298" class="graf graf--p graf-after--pre">Then you don’t need to pass param2,</p><pre name="7e07" id="7e07" class="graf graf--pre graf-after--p">var logger = serviceLocator.get&lt;Person&gt;<strong class="markup--strong markup--pre-strong">(param1:&#39;user&#39;)</strong>;</pre><h4 name="0002" id="0002" class="graf graf--h4 graf-after--pre">5. registerFactoryAsync(FactoryFuncAsync&lt;T&gt; func)</h4><p name="2440" id="2440" class="graf graf--p graf-after--h4">Sometimes we need to instantiate an object asynchronously, we can register those kinds of objects using this method.</p><p name="f5a9" id="f5a9" class="graf graf--p graf-after--p">Consider an example,</p><figure name="dfd6" id="dfd6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/b77225efea00cd1cdad782fa66322234.js"></script></figure><p name="6320" id="6320" class="graf graf--p graf-after--figure">In this scenario, the recent Event can only be created asynchronously. We can register the instance using</p><pre name="651e" id="651e" class="graf graf--pre graf-after--p">serviceLocator.<strong class="markup--strong markup--pre-strong">registerFactoryAsync</strong>&lt;Event&gt;(<br>               () =&gt; <strong class="markup--strong markup--pre-strong">Event.<em class="markup--em markup--pre-em">createRecentEvent</em>()</strong>);</pre><p name="05d8" id="05d8" class="graf graf--p graf-after--pre">To get that instance, we must use <strong class="markup--strong markup--p-strong">getAsync&lt;T&gt;(), </strong>it will return Future&lt;T&gt;</p><pre name="63a5" id="63a5" class="graf graf--pre graf-after--p">void main() async{<br>    Event event = await serviceLocator.<strong class="markup--strong markup--pre-strong">getAsync&lt;Event&gt;()</strong>;<br>    //...<br>} </pre><p name="95a9" id="95a9" class="graf graf--p graf-after--pre">We have async support for all the above-specified methods like</p><ul class="postList"><li name="ca7f" id="ca7f" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">registerSingletonAsync()</strong></li><li name="14ae" id="14ae" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">registerLazySingletonAsync()</strong></li><li name="026d" id="026d" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">registerFactoryParamAsync()</strong></li></ul><p name="37d2" id="37d2" class="graf graf--p graf-after--li graf--trailing">For more info, check the <a href="https://pub.dev/packages/get_it" data-href="https://pub.dev/packages/get_it" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">official docs</a> of get_it</p></div></div></section><section name="f1b7" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="9f34" id="9f34" class="graf graf--h4 graf--leading">Registering using names</h4><p name="401c" id="401c" class="graf graf--p graf-after--h4">What if you want to register two instances of the same type, can we do something like this?</p><figure name="d5e9" id="d5e9" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/8694e9694e01ad731845b95b1e20109b.js"></script><figcaption class="imageCaption">Code that Doesn’t make sense😵</figcaption></figure><p name="303b" id="303b" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">No</strong>, we can’t, it will throw an error because by default get_it allows types to be registered only once. You can change it by setting</p><pre name="0f4a" id="0f4a" class="graf graf--pre graf-after--p">void setUp(){<br><strong class="markup--strong markup--pre-strong">     serviceLocator.allowReassignment=true;<br></strong>     //registrations<br>}</pre><p name="218a" id="218a" class="graf graf--p graf-after--pre">But when you call <strong class="markup--strong markup--p-strong">get&lt;WebService&gt;()</strong>, you will get the WebService that is registered at the end. Then how can we have two instances of the same class and consume them in our code?</p><h4 name="592e" id="592e" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">instanceName parameter</strong></h4><p name="b8a1" id="b8a1" class="graf graf--p graf-after--h4">instanceName is a keyword parameter that we can pass to any registration method while registering the instances. If we use instanceName, our instance is registered with a <strong class="markup--strong markup--p-strong">name along with the type</strong>.</p><figure name="745c" id="745c" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/93c5d678b769b45d005919bb703917ed.js"></script></figure><p name="b4e0" id="b4e0" class="graf graf--p graf-after--figure">We can get the instance by,</p><pre name="96d9" id="96d9" class="graf graf--pre graf-after--p">var webserive = serviceLocator<br>                 .get&lt;MyWebService&gt;(<strong class="markup--strong markup--pre-strong">instanceName: &#39;v2&#39;</strong>); <br>                 // get the second registred webservice</pre><blockquote name="5fd6" id="5fd6" class="graf graf--blockquote graf-after--pre">All the registered instances of the <strong class="markup--strong markup--blockquote-strong">same Type must have unique instanceNames</strong>.</blockquote><p name="1c1a" id="1c1a" class="graf graf--p graf-after--blockquote">Example:</p><figure name="7e45" id="7e45" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/8b66064a032508d3bcdd667268725808.js"></script></figure><p name="64d8" id="64d8" class="graf graf--p graf-after--figure">To get the instances,</p><pre name="5369" id="5369" class="graf graf--pre graf-after--p">var webserive = serviceLocator<br>                 .get&lt;MyWebService&gt;<strong class="markup--strong markup--pre-strong">(instanceName: &#39;v2&#39;)</strong>; <br>                 //will return the second registred MyWebService<br>var db = serviceLocator<br>                 .get&lt;MyDatabase&gt;<strong class="markup--strong markup--pre-strong">(instanceName: &#39;v2&#39;)</strong>;<br>                 //will return the second registred MyDatabase</pre><p name="1b90" id="1b90" class="graf graf--p graf-after--pre">There are still many things that we can do with get_it, the official document has everything covered, you can take a look at it <a href="https://pub.dev/packages/get_it" data-href="https://pub.dev/packages/get_it" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><h4 name="716e" id="716e" class="graf graf--h4 graf-after--p">dispose parameter</h4><p name="b127" id="b127" class="graf graf--p graf-after--h4">Sometimes we need to do some stuff like closing a stream, writing to log while unregistering, or resetting the registered instances. That can be specified in the dispose parameter.</p><pre name="eec4" id="eec4" class="graf graf--pre graf-after--p">serviceLocator.registerSingleton(<br>         MyWebService(),<br>         dispose: (webservice) =&gt; webservice.closeConnection());</pre><p name="763b" id="763b" class="graf graf--p graf-after--pre">Every register method has the dispose functionality.</p><h4 name="b99a" id="b99a" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Unregistering an instance</strong></h4><p name="9620" id="9620" class="graf graf--p graf-after--h4">We can unregister an instance, when we don’t want the instance anymore or when we want to reinitialize it.</p><p name="f0b5" id="f0b5" class="graf graf--p graf-after--p">The syntax is</p><pre name="2c41" id="2c41" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">void</strong> unregister&lt;T&gt;({Object instance,String instanceName, <strong class="markup--strong markup--pre-strong">void</strong> Function(T) disposingFunction})</code></pre><blockquote name="092e" id="092e" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">instance:</strong> The instance to be unregistered.</blockquote><blockquote name="bd91" id="bd91" class="graf graf--blockquote graf-after--blockquote"><strong class="markup--strong markup--blockquote-strong">instanceName:</strong> The name of the registered instance to be unregistred.</blockquote><blockquote name="322a" id="322a" class="graf graf--blockquote graf-after--blockquote"><strong class="markup--strong markup--blockquote-strong">disposingFunction :</strong> The function to be called while unregistering.</blockquote><ol class="postList"><li name="ee08" id="ee08" class="graf graf--li graf-after--blockquote">To unregister by <strong class="markup--strong markup--li-strong">Type </strong>alone, use</li></ol><pre name="8393" id="8393" class="graf graf--pre graf-after--li">serviceLocator.unregister<strong class="markup--strong markup--pre-strong">&lt;MyWebService&gt;</strong>();</pre><p name="c6c7" id="c6c7" class="graf graf--p graf-after--pre">2. To unregister by instanceName, use</p><pre name="6f94" id="6f94" class="graf graf--pre graf-after--p">serviceLocator.unregister&lt;MyWebService&gt;<strong class="markup--strong markup--pre-strong">(instanceName:&#39;v1&#39;)</strong>;</pre><p name="8248" id="8248" class="graf graf--p graf-after--pre">3. To unregister by the instance itself, use</p><pre name="e537" id="e537" class="graf graf--pre graf-after--p">var myWebservice = serviceLocator<br>                     .get&lt;MyWebService&gt;(instanceName:&#39;v1&#39;);<br>// ....<br>serviceLocator.unregister&lt;MyWebService&gt;<strong class="markup--strong markup--pre-strong">(instance:myWebservice)</strong>;</pre><blockquote name="ead1" id="ead1" class="graf graf--blockquote graf-after--pre">When you’ve specified the <strong class="markup--strong markup--blockquote-strong">instance</strong> parameter, <strong class="markup--strong markup--blockquote-strong">instanceName</strong> parameter is not taken into account</blockquote><ul class="postList"><li name="c186" id="c186" class="graf graf--li graf-after--blockquote">If you want to do any disposing function before unregistering the instance you can use the <strong class="markup--strong markup--li-strong">disposingFunction()</strong></li></ul><pre name="c97f" id="c97f" class="graf graf--pre graf-after--li">serviceLocator.unregister&lt;MyWebService&gt;(<br>   <strong class="markup--strong markup--pre-strong">disposingFunction: (webservice)=&gt; webservice.closeConnection()</strong>);</pre><blockquote name="0571" id="0571" class="graf graf--blockquote graf-after--pre">When you specify the disposingFunction()<strong class="markup--strong markup--blockquote-strong">, </strong>the dispose function that you specified while registering the instance is not considered.</blockquote><p name="93f4" id="93f4" class="graf graf--p graf-after--blockquote">To unregister <strong class="markup--strong markup--p-strong">lazySingletons </strong>use,</p><pre name="0c3d" id="0c3d" class="graf graf--pre graf-after--p graf--trailing"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">void</strong> resetLazySingleton&lt;T&gt;({Object instance,<br>                            String instanceName,<br>                            <strong class="markup--strong markup--pre-strong">void</strong> Function(T) disposingFunction})</code></pre></div></div></section><section name="3abd" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="0148" id="0148" class="graf graf--h4 graf--leading">Resetting GetIt completely</h4><p name="6e12" id="6e12" class="graf graf--p graf-after--h4">You can completely delete all the registered instances and start fresh using the <strong class="markup--strong markup--p-strong">reset() </strong>function.</p><p name="3277" id="3277" class="graf graf--p graf-after--p">The syntax is :</p><pre name="7f54" id="7f54" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">Future&lt;<strong class="markup--strong markup--pre-strong">void</strong>&gt; reset({bool dispose = <strong class="markup--strong markup--pre-strong">true</strong>});</code></pre><p name="57bb" id="57bb" class="graf graf--p graf-after--pre">This method comes in very handy when we are doing unit tests, where we want to clear all the registered instances frequently(for every test or every group).</p><pre name="4bee" id="4bee" class="graf graf--pre graf-after--p">await serviceLocator.<strong class="markup--strong markup--pre-strong">reset()</strong>;</pre><ul class="postList"><li name="3460" id="3460" class="graf graf--li graf-after--pre">If <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">dispose=true</strong></code>, will call the dispose functions of every registered type if we’ve specified one while registering.</li><li name="b4c8" id="b4c8" class="graf graf--li graf-after--li">If <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">dispose=false, </strong></code>unregister all the registered types without calling any of the dispose functions.</li></ul><h3 name="8e7e" id="8e7e" class="graf graf--h3 graf-after--li">ServiceLocator design pattern?</h3><p name="a405" id="a405" class="graf graf--p graf-after--h3">If you look at how get_it works, you can clearly see it’s just helping us to find(Locate) the instances(Service) that we’ve already created. That’s why it comes under service Locator design pattern but not under Dependency Injection.</p><p name="110d" id="110d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Dependency Injection</strong></p><p name="b7dd" id="b7dd" class="graf graf--p graf-after--p">Dependency Injection resolves the dependency for you. It will create the dependency of the instance for you behind the scenes.</p><figure name="6f29" id="6f29" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/8185df03cc83002b38ea649c589fc08e.js"></script></figure><p name="d230" id="d230" class="graf graf--p graf-after--figure">If you do dependency injection for the above class, the consoleLogger and the fileLogger <strong class="markup--strong markup--p-strong">will be injected for</strong> <strong class="markup--strong markup--p-strong">you</strong>, when you try to create a HybridLogger. You don’t want to create the dependencies manually and pass them to the constructor.</p><p name="f021" id="f021" class="graf graf--p graf-after--p">But with service Locator you have to inject the dependencies manually, as far as I know, we can inject the dependencies manually in two ways,</p><ol class="postList"><li name="96eb" id="96eb" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Use serviceLocator(GetIt.instance) within the class (not recommended)</strong></li></ol><figure name="063e" id="063e" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/imsaravana369/1a5ea205edfb127abec8196b5d64248c.js"></script></figure><p name="b683" id="b683" class="graf graf--p graf-after--figure">The above code is bad. Why? We may forget to register the dependencies(ConsoleLogger or FileLogger), <strong class="markup--strong markup--p-strong">which may raise a run-time error.</strong></p><p name="f9c1" id="f9c1" class="graf graf--p graf-after--p">Example:</p><figure name="1cd1" id="1cd1" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/6f95d54d82f3448c731a426113d6cc76.js"></script></figure><p name="2aac" id="2aac" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. Constructor Injection + get_it (good practice)</strong></p><figure name="8237" id="8237" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/6175b48938ae9465b24f1eb65b736efa.js"></script></figure><p name="d27a" id="d27a" class="graf graf--p graf-after--figure">This will help us to achieve dependency injection(to some extent) through <code class="markup--code markup--p-code">get_it </code>, but still, we have to create all the instances and pass them manually.</p><figure name="3571" id="3571" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/8e72dd8333bce537254f71939033904e.js"></script></figure><p name="35c1" id="35c1" class="graf graf--p graf-after--figure">This ensures we register all our dependencies. But when our app gets too big it’s better to use a dependency-injection package like <a href="https://pub.dev/packages/injectable" data-href="https://pub.dev/packages/injectable" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">injectable</a>.</p><blockquote name="de40" id="de40" class="graf graf--blockquote graf--hasDropCapModel graf-after--p graf--trailing">The main difference is how the dependencies are located, in Service Locator, client code request the dependencies, in DI Container we use a container to create all of objects and it injects dependency as constructor parameters (or properties).</blockquote></div></div></section><section name="d6b4" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="658e" id="658e" class="graf graf--p graf--leading">Hope you’ve got some insights into the get_it and how the get_it package can be used to manage our dependencies efficiently, there is so much to explore in the get_it package. Please don’t forget to check the <a href="https://pub.dev/packages/get_it" data-href="https://pub.dev/packages/get_it" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">official documentation</a>.</p><p name="65cb" id="65cb" class="graf graf--p graf-after--p graf--trailing">If you’ve found any wrong information in this article please mention that in the comments, that would be of great help. Thank you for reading, clap 👏 if you’ve liked this article.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@imsaravananm" class="p-author h-card">Saravanan M</a> on <a href="https://medium.com/p/5e50671bbbcb"><time class="dt-published" datetime="2021-07-14T10:34:30.669Z">July 14, 2021</time></a>.</p><p><a href="https://medium.com/@imsaravananm/implement-service-locator-design-pattern-with-get-it-flutter-5e50671bbbcb" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 7, 2023.</p></footer></article></body></html>