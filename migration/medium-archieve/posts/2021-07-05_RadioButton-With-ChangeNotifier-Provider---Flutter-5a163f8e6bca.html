<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>RadioButton With ChangeNotifier Provider — Flutter</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">RadioButton With ChangeNotifier Provider — Flutter</h1>
</header>
<section data-field="subtitle" class="p-summary">
In this article, I will tell you how we can use radio buttons with ChangeNotifier without mixing the UI and business logic.
</section>
<section data-field="body" class="e-content">
<section name="7991" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ec04" id="ec04" class="graf graf--h3 graf--leading graf--title">RadioButton With ChangeNotifier Provider — Flutter</h3><p name="6e78" id="6e78" class="graf graf--p graf-after--h3">In this article, I will tell you how we can use radio buttons with ChangeNotifier without mixing the UI and business logic.</p><p name="6c7e" id="6c7e" class="graf graf--p graf-after--p">It’s very crucial to move our business logic out of our UI so that we can easily maintain and unit test our code, but it&#39;s pretty hard in flutter because both the UI and business logic are written in one programing language — Dart. So we are going to write all our business logic in the ChangeNotifier provider leaving our UI very lean and clean. (Not gonna use <strong class="markup--strong markup--p-strong">setState()</strong>)</p><p name="f2ec" id="f2ec" class="graf graf--p graf-after--p">We are going to create an app that looks like this,</p><figure name="cda7" id="cda7" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://www.youtube.com/embed/21c2G_1kBS0?feature=oembed" width="700" height="393" frameborder="0" scrolling="no"></iframe></figure><h4 name="d774" id="d774" class="graf graf--h4 graf-after--figure">What our App will do</h4><ol class="postList"><li name="4510" id="4510" class="graf graf--li graf-after--h4">Users can tap any of the radio buttons on the Home screen and the corresponding style will be fetched from our fake-API.</li><li name="b83f" id="b83f" class="graf graf--li graf-after--li">Our fake-API will respond with JSON containing the text style format and some other meta-data.</li><li name="d190" id="d190" class="graf graf--li graf-after--li">We will use the text style from the JSON and render the ‘Hello World’ text on the home screen with it.</li></ol><p name="8b54" id="8b54" class="graf graf--p graf-after--li">The architecture diagram is,</p><figure name="8463" id="8463" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TGGwuP3lX9jxL8J9AFF7Rw.png" data-width="848" data-height="654" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*TGGwuP3lX9jxL8J9AFF7Rw.png"></figure><p name="9735" id="9735" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Presentation Layer</strong> — This is our UI layer, we will be writing all our UI code here.</p><p name="2c7f" id="2c7f" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Business Layer</strong> — All our logic goes into this layer. ChangeNotifier goes here and will make use of the service class to fetch the data.</p><p name="24e6" id="24e6" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Data Layer</strong> — The service class is used to fetch the data from our Fake REST-API and convert it into a Data Transfer Object(DTO)</p><p name="5aed" id="5aed" class="graf graf--p graf-after--p">Code Structure</p><figure name="ba75" id="ba75" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*e34NYHASsAQ_NuhMLcBZlw.png" data-width="322" data-height="127" src="https://cdn-images-1.medium.com/max/800/1*e34NYHASsAQ_NuhMLcBZlw.png"></figure><p name="6067" id="6067" class="graf graf--p graf-after--figure">To keep it very simple I have only 3 layers, I could’ve separated all the service classes into a service package, since our app is so small and has only one service class I preferred this structure.</p><p name="1207" id="1207" class="graf graf--p graf-after--p">This is <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">not a very sophisticated structure</em></strong>, I will write an article about how we can structure our code more granularly.</p><p name="62f4" id="62f4" class="graf graf--p graf-after--p">Let’s start from the Data layer,</p><h3 name="2811" id="2811" class="graf graf--h3 graf-after--p">Data Layer</h3><p name="1c18" id="1c18" class="graf graf--p graf-after--h3">First, let’s create our model(DTO) class,</p><p name="b6ab" id="b6ab" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Model Class</strong></p><figure name="a3e9" id="a3e9" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/5cb4859fb692499ec3856f500c2c2700.js"></script><figcaption class="imageCaption">I haven’t done many validation checks here, but if you want you can</figcaption></figure><p name="78f0" id="78f0" class="graf graf--p graf-after--figure">This is a Data Transfer Object. What is a DTO?</p><blockquote name="bd94" id="bd94" class="graf graf--blockquote graf-after--p">A Data Transfer Object is an object that is used to encapsulate data, and send it from one subsystem of an application to another and has no other logic written in it except serialization logic and deserialization(<strong class="markup--strong markup--blockquote-strong">fromJson() </strong>here) logic.(<a href="https://en.wikipedia.org/wiki/Data_transfer_object" data-href="https://en.wikipedia.org/wiki/Data_transfer_object" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">see here</a>)</blockquote><p name="50a3" id="50a3" class="graf graf--p graf-after--blockquote">This class contains some <strong class="markup--strong markup--p-strong">text-style fields</strong> like color,fontWeight,fontSize, and some other <strong class="markup--strong markup--p-strong">meta-data</strong> like home many people liked the text style.</p><p name="ec25" id="ec25" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Service class</strong></p><figure name="87d5" id="87d5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/e5ac4e4c2f6029cb72cf0f70c06b7ea6.js"></script></figure><p name="ab33" id="ab33" class="graf graf--p graf-after--figure">In the service layer, we usually make HTTP requests to fetch data(any CRUD operation) from a server or access data in the local database and parse the response from raw data(JSON, XML, etc) to a Data Transfer Object.</p><p name="0bf9" id="0bf9" class="graf graf--p graf-after--p">To make this article very short, I have made 5 fake JSON responses and stored them in a list.</p><p name="28f7" id="28f7" class="graf graf--p graf-after--p">But this is how we can request data from our REST-API,</p><pre name="2bf9" id="2bf9" class="graf graf--pre graf-after--p">Future&lt;TextStyleResponse&gt; fetchTextStyle(int index) async{<br>    Uri uri = Uri.<em class="markup--em markup--pre-em">parse</em>(&quot;www.myapi.com/styles/$index&quot;);<br>    var response = await http.get(uri);<br>    Map&lt;String,dynamic&gt; responseMap = json.decode(response.body);<br>    return TextStyleResponse.fromJson(responseMap);<br>}</pre><p name="6cb8" id="6cb8" class="graf graf--p graf-after--pre graf--trailing">Since we are done with our data layer, let’s move on to our business logic layer</p></div></div></section><section name="ea36" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="a720" id="a720" class="graf graf--h3 graf--leading">Business Layer</h3><p name="29d2" id="29d2" class="graf graf--p graf-after--h3">We can use any state management libraries like Bloc,mobX, etc. But since our app is very small I’m going with Provider.</p><p name="64bf" id="64bf" class="graf graf--p graf-after--p">To use the change notifier provider, install the provider package</p><pre name="07b0" id="07b0" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">dependencies:<br>  provider: ^5.0.0</code></pre><figure name="d594" id="d594" class="graf graf--figure graf--iframe graf-after--pre"><script src="https://gist.github.com/imsaravana369/23f932cd6acbec86bfd77b9983919120.js"></script></figure><ul class="postList"><li name="b2b3" id="b2b3" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">int selectedButton — </strong>This will hold the value of which radio button is selected.</li><li name="bdf4" id="bdf4" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">TextStyle _style — </strong>This will decide which text style will be applied to the ‘Hello World’ text on our home screen.</li><li name="62f5" id="62f5" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">TextStyleService service</strong> — An instance of our TextStyleService class.</li><li name="4630" id="4630" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">int likes — </strong>Number of people who liked the current text-style that we have fetched from our fake-API.</li><li name="373b" id="373b" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">int totalResponses — </strong>Total number of text styles available in our fake-API.</li></ul><h4 name="9cb0" id="9cb0" class="graf graf--h4 graf-after--li">what we do in setSelectedButton(index) function?</h4><ol class="postList"><li name="c6b7" id="c6b7" class="graf graf--li graf-after--h4">Check if the passed index is not null then update the value, otherwise set it to the previously selected button without changing it.</li></ol><pre name="5ab8" id="5ab8" class="graf graf--pre graf-after--li"> selectedButton = index?? selectedButton;</pre><p name="0006" id="0006" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">2. Fetch the response and update the fields.</strong></p><pre name="f9dd" id="f9dd" class="graf graf--pre graf-after--p">var response = await service.fetchTextStyle(selectedButton);<br>_style = TextStyle(<br>        fontSize: response.fontSize,<br>        fontWeight: response.fontWeight,<br>        color: response.color,<br>       );<br>likes = response.likes;</pre><p name="096e" id="096e" class="graf graf--p graf-after--pre">we could’ve passed the JSON map response directly without parsing it into a TextStyleResponse object but it’s not a good practice. Since it will make our Data and Business logic layer coupled.</p><p name="83c1" id="83c1" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">3.Notify the listeners (Important step)</strong></p><pre name="4cc5" id="4cc5" class="graf graf--pre graf-after--p">notifyListeners();</pre><p name="2807" id="2807" class="graf graf--p graf-after--pre graf--trailing">This is the most important. This will signal all the widgets that are listening to the provider to rebuild. If you don’t call this, none of them will rebuild, even though the values are changed.</p></div></div></section><section name="b931" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="4261" id="4261" class="graf graf--h4 graf--leading">Presentation Layer</h4><p name="cd0d" id="cd0d" class="graf graf--p graf-after--h4">First, let’s create the radio button list, We can quite easily do that using ListViewBuilder with RadioListTile as items.</p><figure name="5329" id="5329" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/c21597659f73766edf63c9d9b8f5490c.js"></script></figure><h4 name="2052" id="2052" class="graf graf--h4 graf-after--figure">RadioListTile</h4><ul class="postList"><li name="d385" id="d385" class="graf graf--li graf-after--h4">RadioListTile are nothing but a radio button with a label.</li><li name="af79" id="af79" class="graf graf--li graf-after--li">The <strong class="markup--strong markup--li-strong">title </strong>field indicates the label of the radio button.</li><li name="d96e" id="d96e" class="graf graf--li graf-after--li">The <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">value </em></strong>field inside a RadioListTile indicates the value(like ID) of it.</li><li name="bfcc" id="bfcc" class="graf graf--li graf-after--li">The <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">groupValue </em></strong>field indicates the value of the selected radio button in the radio group. If <strong class="markup--strong markup--li-strong">groupValue == value</strong>, then the current radio button is checked otherwise not.</li><li name="d911" id="d911" class="graf graf--li graf-after--li">The onChanged callback will be called when the tile is tapped.</li></ul><p name="bbe0" id="bbe0" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">ChangeNotifierProvider</strong></p><p name="9668" id="9668" class="graf graf--p graf-after--p">The below line will fetch the TextStyleProvider by <strong class="markup--strong markup--p-strong">looking up</strong> the widget hierarchy. (we haven’t provided the TextStyleProvider yet)</p><pre name="298e" id="298e" class="graf graf--pre graf-after--p">var provider = Provider.of&lt;TextStyleProvider&gt;(context);</pre><p name="1447" id="1447" class="graf graf--p graf-after--pre">By passing the <strong class="markup--strong markup--p-strong">context</strong>, we are registering the widget as a listener to the provider, it will <strong class="markup--strong markup--p-strong">rebuild whenever notifyListeners() is called</strong> from that provider.</p><p name="95ad" id="95ad" class="graf graf--p graf-after--p">If you don’t want the behavior, you can choose not to listen to the changes by passing — <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">listen:false</em></strong></p><pre name="8779" id="8779" class="graf graf--pre graf-after--p">var provider = Provider.of&lt;TextStyleProvider&gt;(context,listen:false);</pre><h4 name="d89b" id="d89b" class="graf graf--h4 graf-after--pre">HeaderText</h4><p name="7e87" id="7e87" class="graf graf--p graf-after--h4">This Widget is used for displaying the Hello World text.</p><figure name="4416" id="4416" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/bd2d0207c9aab8695b7dbecc6137687f.js"></script></figure><p name="5d66" id="5d66" class="graf graf--p graf-after--figure">I think this widget is quite self-explanatory. We are getting the title of our widget(the center text) and the number of likes as parameters from our constructor.</p><h4 name="76ac" id="76ac" class="graf graf--h4 graf-after--p">We are done, Almost…</h4><p name="3d08" id="3d08" class="graf graf--p graf-after--h4">Now let’s wire our TextStyleProvider from our main.dart</p><figure name="9290" id="9290" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/imsaravana369/fdd1e6eec6996ea60206e18781d7b4f1.js"></script></figure><p name="a8a5" id="a8a5" class="graf graf--p graf-after--figure">How will you provide the TextStyleProvider instance?</p><ul class="postList"><li name="3083" id="3083" class="graf graf--li graf-after--p">We know the children get the instance of the needed provider from their ancestors(by looking up the widget tree).</li><li name="9fdc" id="9fdc" class="graf graf--li graf-after--li">Since only the children of MyHomePage() are using TextStyleProvider, we can wrap only the MyHomePage widget with ChangeNotifierProvider.</li><li name="5d72" id="5d72" class="graf graf--li graf-after--li">If you want to provide your provider <strong class="markup--strong markup--li-strong">globally </strong>just wrap <strong class="markup--strong markup--li-strong">MaterialApp </strong>with ChangeNotifierProvider()</li></ul><blockquote name="c16e" id="c16e" class="graf graf--blockquote graf-after--li">If you want to provide more than one provider, use <code class="markup--code markup--blockquote-code">MultiProvider()</code></blockquote><h4 name="cac1" id="cac1" class="graf graf--h4 graf-after--blockquote">MyHomePage()</h4><figure name="01a7" id="01a7" class="graf graf--figure graf--iframe graf-after--h4"><script src="https://gist.github.com/imsaravana369/0af1f1efb43a3d96cf6b972786affe98.js"></script></figure><p name="a2d2" id="a2d2" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Line 24</em>: The reason why I’ve wrapped <strong class="markup--strong markup--p-strong">TextRadioList </strong>with <strong class="markup--strong markup--p-strong">Expaned() </strong>is we can’t directly nest ListView inside the Column widget. Why?</p><blockquote name="0b80" id="0b80" class="graf graf--blockquote graf-after--p">A <code class="markup--code markup--blockquote-code">ListView</code> takes all the vertical space available to it, unless it’s constrained by its parent widget. However, a <code class="markup--code markup--blockquote-code">Column</code> doesn’t impose any constraint on its children’s height by default. The combination of the two behaviors leads to the failure of determining the size of the <code class="markup--code markup--blockquote-code">ListView</code>.</blockquote><h4 name="1102" id="1102" class="graf graf--h4 graf-after--blockquote">Solution:</h4><ol class="postList"><li name="e2c3" id="e2c3" class="graf graf--li graf-after--h4"><strong class="markup--strong markup--li-strong">Wrap the TextRadioList with Expanded.</strong></li></ol><p name="3b1a" id="3b1a" class="graf graf--p graf-after--li">Expanded will force the nested widget to acquire all the remaining space of its parent(after laying out the widgets with a fixed size. More about this <a href="https://api.flutter.dev/flutter/widgets/Column-class.html" data-href="https://api.flutter.dev/flutter/widgets/Column-class.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">here</em></a>)</p><p name="5bfc" id="5bfc" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. Make ShrinkWrap to true in ListView (not recommended)</strong></p><p name="f106" id="f106" class="graf graf--p graf-after--p">This will make the listview acquire only the space it needs.</p><blockquote name="4a33" id="4a33" class="graf graf--blockquote graf-after--p">Shrink wrapping the content of the scroll view is significantly <strong class="markup--strong markup--blockquote-strong">more expensive</strong> than expanding to the maximum allowed size because the content can expand and contract during scrolling, which means the size of the scroll view needs to be recomputed whenever the scroll position changes. (<a href="https://api.flutter.dev/flutter/widgets/ScrollView/shrinkWrap.html" data-href="https://api.flutter.dev/flutter/widgets/ScrollView/shrinkWrap.html" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">Docs</a>)</blockquote><p name="25d2" id="25d2" class="graf graf--p graf-after--blockquote">what you have learned from this article is,</p><ol class="postList"><li name="6945" id="6945" class="graf graf--li graf-after--p">How to use RadioListTile?</li><li name="9e28" id="9e28" class="graf graf--li graf-after--li">How to use the ChangeNotifier provider?</li><li name="2bf8" id="2bf8" class="graf graf--li graf-after--li">Why Listview can’t be a direct child of the Column widget?</li><li name="f767" id="f767" class="graf graf--li graf-after--li">How to parse JSON Responses to a DTO object?</li><li name="fc95" id="fc95" class="graf graf--li graf-after--li">Where to provide a ChangeNotifier Provider?</li></ol><p name="6da2" id="6da2" class="graf graf--p graf-after--li graf--trailing">Thank you for going through this article. Hope I’ve shared something relevant and useful with you.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@imsaravananm" class="p-author h-card">Saravanan M</a> on <a href="https://medium.com/p/5a163f8e6bca"><time class="dt-published" datetime="2021-07-05T06:11:40.459Z">July 5, 2021</time></a>.</p><p><a href="https://medium.com/@imsaravananm/radiobutton-with-changenotifier-provider-flutter-5a163f8e6bca" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 7, 2023.</p></footer></article></body></html>